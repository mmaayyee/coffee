webpackJsonp([1],{"/Hv2":function(t,e){},"8aiT":function(t,e){},CuRo:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("CuRo");var r=a("IvJb"),n=a("t+b9"),o=a.n(n),l=(a("/Hv2"),{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]}),i=a("C7Lr")(null,l,!1,null,null,null).exports,s=a("zO6J"),c=a("aozt"),u=a.n(c),h=["#328e55","#d66e49","#be384b","#a7aa9d","#354b5e"],p=["#54c7f1","#3ab2de","#289eca","#198db8","#0a7da7","#016b93"],m={data:function(){return{listUrl:"",getMonthlyRevenueUrl:rootCoffeeStieUrl+"monthly-report-api/monthly-revenues-list.html",monthlyRevenueData:[],labelPosition:"right",form:{searchDateStart:"",searchDateEnd:""},searchDatePickerOption:{disabledDate:function(t){return t.getTime()>Date.now()}},exportDate:"",exportUrl:"/monthly-revenue/export?",showDateSearch:""}},filters:{formatDate:function(t){return String(t).substr(0,10)}},computed:{},mounted:function(){this.init()},methods:{init:function(){var t=this;this.showDateSearch=String(rootLogin),window.parent.onscroll=function(e){t.scrollMsg()},this.getMonthlyRevenue()},trimPercent:function(t){return"%"==String(t).charAt(String(t).length-1)?Number(String(t).substr(0,String(t).length-1)):Number(t)},searchDate:function(){var t=new Date(this.form.searchDateStart);new Date(this.form.searchDateEnd)>=t?this.getMonthlyRevenue([this.form.searchDateStart,this.form.searchDateEnd]):this.alertMsg("结束月必须大于等于开始月，请重新选择。")},exportExcel:function(){},goBack:function(){},clearCharts:function(){this.monthlyRevenueData=[],this.initCharts()},getMonthlyRevenue:function(t){var e=this,a=t?this.getMonthlyRevenueUrl+"?start="+t[0]+"&end="+t[1]:this.getMonthlyRevenueUrl;this.exportDate=t?"start="+t[0]+"&end="+t[1]:"",u.a.get(a).then(function(t){t.data&&"200"==t.data.code?(0==t.data.data.length&&e.alertMsg("没有数据，请选择其他日期"),e.monthlyRevenueData=[],window.setTimeout(function(){e.monthlyRevenueData=t.data.data,e.initCharts()},300)):(e.clearCharts(),e.alertMsg("获取月报营收数据错误"))}).catch(function(t){e.clearCharts(),e.alertMsg("月报营收接口错误")})},initCharts:function(){this.equipNoMiniChart(),this.monthlyTurnoverChart(),this.monthlyFreeCupsChart(),this.monthlyCupsChart(),this.equipDailyAverageChart(),this.monthlyCupsAverageChart(),this.monthlyPayCupsChart(),this.payEquipDailyAverageChart(),this.payCupsAverageChart()},equipNoMiniChart:function(){this.initSingleChart("monthlyRevenueData","month","equipNoMini","equip_no_mini","设备台数(除mini)")},monthlyTurnoverChart:function(){this.initSingleChart("monthlyRevenueData","month","monthlyTurnover","monthly_turnover","营业额")},monthlyFreeCupsChart:function(){this.initDoubleChart("monthlyRevenueData","month","monthlyFreeCups","monthly_free_cups","new_registered_user","免费杯数 对比 新增注册用户","免费杯数","新增注册用户")},monthlyCupsChart:function(){this.initSingleChart("monthlyRevenueData","month","monthlyCups","monthly_cups","总杯数")},equipDailyAverageChart:function(){this.initSingleLineChart("monthlyRevenueData","month","equipDailyAverage","equip_daily_average","总台日均(杯数)")},monthlyCupsAverageChart:function(){this.initSingleLineChart("monthlyRevenueData","month","monthlyCupsAverage","monthly_cups_average","总杯均价")},monthlyPayCupsChart:function(){this.initSingleChart("monthlyRevenueData","month","monthlyPayCups","monthly_pay_cups","付费杯数")},payEquipDailyAverageChart:function(){this.initSingleLineChart("monthlyRevenueData","month","payEquipDailyAverage","pay_equip_daily_average","付费台日均(杯数)")},payCupsAverageChart:function(){this.initSingleLineChart("monthlyRevenueData","month","payCupsAverage","pay_cups_average","付费杯均价")},initSingleLineChart:function(t,e,a,r,n){var o=echarts.init(document.getElementById(a));o.clear();for(var l=[],i=[],s=this[t],c=0,u=s.length;c<u;c++)l.push(s[c][e]),i.push(Number(s[c][r]));var p={color:h,backgroundColor:"#fff",title:{text:n,textStyle:{fontSize:16}},tooltip:{},legend:{data:[n]},xAxis:{data:l},yAxis:{},series:[{name:n,type:"line",data:i,itemStyle:{normal:{label:{show:!0}}}}]};o.setOption(p)},initSingleChart:function(t,e,a,r,n){var o=echarts.init(document.getElementById(a));o.clear();for(var l=[],i=[],s=this[t],c=0,u=s.length;c<u;c++)l.push(s[c][e]),i.push(Number(s[c][r]));var h=i.length>0?i.reduce(function(t,e){return t>e?t:e}):0,m={color:p,backgroundColor:"#fff",title:{text:n,textStyle:{fontSize:16}},tooltip:{},legend:{data:[n]},xAxis:{data:l},yAxis:{},series:[{name:n,type:"bar",barMaxWidth:30,data:i,itemStyle:{normal:{label:{show:!0},color:function(t){var e=Number(t.value);e=Math.max(0,e);var a=h>0?Math.floor(5*e/h):0;return p[a]}}}}]};o.setOption(m)},initDoubleChart:function(t,e,a,r,n,o,l,i){var s=echarts.init(document.getElementById(a));s.clear();for(var c=[],u=[[],[]],p=this[t],m=0,y=p.length;m<y;m++)c.push(p[m][e]),u[0].push(p[m][r]),u[1].push(p[m][n]);var v={color:h,backgroundColor:"#fff",title:{text:o,textStyle:{fontSize:16}},tooltip:{},legend:{data:[l,i]},xAxis:{data:c},yAxis:{},series:[{name:l,type:"bar",barMaxWidth:20,data:u[0],itemStyle:{normal:{label:{show:!0}}}},{name:i,type:"bar",barMaxWidth:20,data:u[1],itemStyle:{normal:{label:{show:!0}}}}]};s.setOption(v)},alertMsg:function(t,e){this.scrollMsg();var a=e||"error";this.$message({message:t,duration:3600,type:a})},scrollMsg:function(){if(self!=top){var t=window.parent.document.documentElement.scrollTop||window.parent.document.body.scrollTop-50,e=document.getElementsByClassName("el-message")[0];e&&(e.style.cssText="top: "+t+"px;z-index:1000;")}}},components:{}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-body"},["0"!=t.showDateSearch?a("el-form",{ref:"form",attrs:{"label-position":t.labelPosition,model:t.form,size:"small","label-width":"120px"}},[a("el-row",{attrs:{gutter:10}},["1"!=t.showDateSearch?a("el-col",{staticStyle:{width:"350px"},attrs:{span:6}},[a("span",{staticClass:"demonstration"},[t._v("选择检索月")]),t._v(" "),a("el-date-picker",{attrs:{type:"month",placeholder:"开始月",format:"yyyy-MM","value-format":"yyyy-MM","picker-options":t.searchDatePickerOption},model:{value:t.form.searchDateStart,callback:function(e){t.$set(t.form,"searchDateStart",e)},expression:"form.searchDateStart"}}),t._v(" 至\n      ")],1):t._e(),t._v(" "),"1"!=t.showDateSearch?a("el-col",{staticStyle:{width:"250px"},attrs:{span:6}},[a("el-date-picker",{attrs:{type:"month",placeholder:"结束月",format:"yyyy-MM","value-format":"yyyy-MM","picker-options":t.searchDatePickerOption},model:{value:t.form.searchDateEnd,callback:function(e){t.$set(t.form,"searchDateEnd",e)},expression:"form.searchDateEnd"}})],1):t._e(),t._v(" "),"1"!=t.showDateSearch?a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.searchDate}},[t._v("检索")])],1):t._e(),t._v(" "),a("el-col",{attrs:{span:5}},["2"!=t.showDateSearch?a("a",{attrs:{href:t.exportUrl+t.exportDate}},[a("el-button",{attrs:{type:"primary",plain:""}},[t._v("导出")])],1):t._e()])],1)],1):t._e(),t._v(" "),a("el-table",{staticClass:"el-table-common",attrs:{data:t.monthlyRevenueData,border:""}},[a("el-table-column",{attrs:{prop:"year",label:"年份"}}),t._v(" "),a("el-table-column",{attrs:{prop:"month",label:"月份"}}),t._v(" "),a("el-table-column",{attrs:{prop:"equip_no_mini",label:"设备台数(除mini)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"equip_total",label:"总设备台数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"monthly_turnover",label:"本期营业额"}}),t._v(" "),a("el-table-column",{attrs:{label:"营业额增长率"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.trimPercent(e.row.monthly_growth)<0?a("span",[a("i",{staticClass:"el-icon-download",staticStyle:{color:"green"}})]):t.trimPercent(e.row.monthly_growth)>0?a("span",[a("i",{staticClass:"el-icon-upload2",staticStyle:{color:"red"}})]):t._e(),t._v(t._s(e.row.monthly_growth)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"average_daily_turnover",label:"日均营业额"}}),t._v(" "),a("el-table-column",{attrs:{prop:"equip_operating_no_mini",label:"运营设备台天数(除mini)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"equip_operating_days",label:"总设备台天数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"monthly_cups",label:"总杯数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"monthly_pay_cups",label:"付费杯数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"equip_daily_average",label:"总台日均(杯数)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"monthly_cups_average",label:"总杯均价"}}),t._v(" "),a("el-table-column",{attrs:{prop:"pay_equip_daily_average",label:"付费台日均(杯数)"}}),t._v(" "),a("el-table-column",{attrs:{label:"环比值"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.trimPercent(e.row.pay_equip_average_ratio)<0?a("span",[a("i",{staticClass:"el-icon-download",staticStyle:{color:"green"}})]):t.trimPercent(e.row.pay_equip_average_ratio)>0?a("span",[a("i",{staticClass:"el-icon-upload2",staticStyle:{color:"red"}})]):t._e(),t._v(t._s(e.row.pay_equip_average_ratio)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"pay_cups_average",label:"付费杯均价"}}),t._v(" "),a("el-table-column",{attrs:{label:"环比值"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.trimPercent(e.row.pay_cups_ratio)<0?a("span",[a("i",{staticClass:"el-icon-download",staticStyle:{color:"green"}})]):t.trimPercent(e.row.pay_cups_ratio)>0?a("span",[a("i",{staticClass:"el-icon-upload2",staticStyle:{color:"red"}})]):t._e(),t._v(t._s(e.row.pay_cups_ratio)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"monthly_free_cups",label:"免费杯数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"monthly_gross_profit",label:"毛利润"}})],1),t._v(" "),t._m(0)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"charts",attrs:{id:"equipNoMini"}}),t._v(" "),a("div",{staticClass:"charts",attrs:{id:"monthlyTurnover"}}),t._v(" "),a("div",{staticClass:"charts",attrs:{id:"monthlyFreeCups"}}),t._v(" "),a("div",{staticClass:"charts",attrs:{id:"monthlyCups"}}),t._v(" "),a("div",{staticClass:"charts",attrs:{id:"equipDailyAverage"}}),t._v(" "),a("div",{staticClass:"charts",attrs:{id:"monthlyCupsAverage"}}),t._v(" "),a("div",{staticClass:"charts",attrs:{id:"monthlyPayCups"}}),t._v(" "),a("div",{staticClass:"charts",attrs:{id:"payEquipDailyAverage"}}),t._v(" "),a("div",{staticClass:"charts",attrs:{id:"payCupsAverage"}})])}]};var v=a("C7Lr")(m,y,!1,function(t){a("8aiT")},"data-v-2092fb65",null).exports;r.default.use(s.a);var d=new s.a({routes:[{path:"/",redirect:"/revenue"},{path:"/revenue",name:"MonthlyRevenue",component:v}]});r.default.use(o.a),r.default.config.productionTip=!1,new r.default({el:"#app",router:d,components:{App:i},template:"<App/>"})}},["NHnr"]);
//# sourceMappingURL=app.58b909a15712b8c59ad1.js.map