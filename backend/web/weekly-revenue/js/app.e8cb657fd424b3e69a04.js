webpackJsonp([1],{"/Hv2":function(e,t){},CuRo:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("CuRo");var r=a("IvJb"),l=a("t+b9"),n=a.n(l),i=(a("/Hv2"),{render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]}),s=a("C7Lr")(null,i,!1,null,null,null).exports,o=a("zO6J"),u=a("aozt"),c=a.n(u),p=["#328e55","#d66e49","#be384b","#a7aa9d","#354b5e"],y=["#54c7f1","#3ab2de","#289eca","#198db8","#0a7da7","#016b93"],h={data:function(){return{listUrl:"",getWeeklyRevenueUrl:rootCoffeeStieUrl+"weekly-report-api/weekly-revenues-list.html",weeklyRevenueData:[],labelPosition:"right",form:{searchDate:""},searchDatePickerOption:{disabledDate:function(e){return e.getTime()>Date.now()}},exportDate:"",exportUrl:"/weekly-revenue/export?",showDateSearch:""}},filters:{formatDate:function(e){return String(e).substr(0,10)}},computed:{},mounted:function(){this.init()},methods:{init:function(){var e=this;this.showDateSearch=String(rootLogin),window.parent.onscroll=function(t){e.scrollMsg()},this.getWeeklyRevenue()},trimPercent:function(e){return"%"==String(e).charAt(String(e).length-1)?Number(String(e).substr(0,String(e).length-1)):Number(e)},searchDate:function(){this.getWeeklyRevenue(this.form.searchDate)},exportExcel:function(){},goBack:function(){},clearCharts:function(){this.weeklyRevenueData=[],this.initCharts()},getWeeklyRevenue:function(e){var t=this,a=e?this.getWeeklyRevenueUrl+"?start="+e[0]+"&end="+e[1]:this.getWeeklyRevenueUrl;this.exportDate=e?"start="+e[0]+"&end="+e[1]:"",c.a.get(a).then(function(e){e.data&&"200"==e.data.code?(0==e.data.data.length&&t.alertMsg("没有数据，请选择其他日期"),t.weeklyRevenueData=[],window.setTimeout(function(){t.weeklyRevenueData=e.data.data,t.initCharts()},300)):(t.clearCharts(),t.alertMsg("获取周报营收数据错误"))}).catch(function(e){t.clearCharts(),t.alertMsg("周报营收接口错误")})},initCharts:function(){this.equipNoMiniChart(),this.weeklyTurnoverChart(),this.weeklyFreeCupsChart(),this.weeklyCupsChart(),this.equipDailyAverageChart(),this.weeklyCupsAverageChart(),this.weeklyPayCupsChart(),this.payEquipDailyAverageChart(),this.payCupsAverageChart()},equipNoMiniChart:function(){this.initSingleChart("weeklyRevenueData","weekly_number","equipNoMini","equip_no_mini","设备台数(除mini)")},weeklyTurnoverChart:function(){this.initSingleChart("weeklyRevenueData","weekly_number","weeklyTurnover","weekly_turnover","营业额")},weeklyFreeCupsChart:function(){this.initDoubleChart("weeklyRevenueData","weekly_number","weeklyFreeCups","weekly_free_cups","new_registered_user","免费杯数 对比 新增注册用户","免费杯数","新增注册用户")},weeklyCupsChart:function(){this.initSingleChart("weeklyRevenueData","weekly_number","weeklyCups","weekly_cups","总杯数")},equipDailyAverageChart:function(){this.initSingleLineChart("weeklyRevenueData","weekly_number","equipDailyAverage","equip_daily_average","总台日均(杯数)")},weeklyCupsAverageChart:function(){this.initSingleLineChart("weeklyRevenueData","weekly_number","weeklyCupsAverage","weekly_cups_average","总杯均价")},weeklyPayCupsChart:function(){this.initSingleChart("weeklyRevenueData","weekly_number","weeklyPayCups","weekly_pay_cups","付费杯数")},payEquipDailyAverageChart:function(){this.initSingleLineChart("weeklyRevenueData","weekly_number","payEquipDailyAverage","pay_equip_daily_average","付费台日均(杯数)")},payCupsAverageChart:function(){this.initSingleLineChart("weeklyRevenueData","weekly_number","payCupsAverage","pay_cups_average","付费杯均价")},initSingleLineChart:function(e,t,a,r,l){var n=echarts.init(document.getElementById(a));n.clear();for(var i=[],s=[],o=this[e],u=0,c=o.length;u<c;u++)i.push(o[u][t]),s.push(Number(o[u][r]));var y={color:p,backgroundColor:"#fff",title:{text:l,textStyle:{fontSize:16}},tooltip:{},legend:{data:[l]},xAxis:{data:i},yAxis:{},series:[{name:l,type:"line",data:s,itemStyle:{normal:{label:{show:!0}}}}]};n.setOption(y)},initSingleChart:function(e,t,a,r,l){var n=echarts.init(document.getElementById(a));n.clear();for(var i=[],s=[],o=this[e],u=0,c=o.length;u<c;u++)i.push(o[u][t]),s.push(Number(o[u][r]));var p=s.length>0?s.reduce(function(e,t){return e>t?e:t}):0,h={color:y,backgroundColor:"#fff",title:{text:l,textStyle:{fontSize:16}},tooltip:{},legend:{data:[l]},xAxis:{data:i},yAxis:{},series:[{name:l,type:"bar",barMaxWidth:30,data:s,itemStyle:{normal:{label:{show:!0},color:function(e){var t=Number(e.value);t=Math.max(0,t);var a=p>0?Math.floor(5*t/p):0;return y[a]}}}}]};n.setOption(h)},initDoubleChart:function(e,t,a,r,l,n,i,s){var o=echarts.init(document.getElementById(a));o.clear();for(var u=[],c=[[],[]],y=this[e],h=0,v=y.length;h<v;h++)u.push(y[h][t]),c[0].push(y[h][r]),c[1].push(y[h][l]);var d={color:p,backgroundColor:"#fff",title:{text:n,textStyle:{fontSize:16}},tooltip:{},legend:{data:[i,s]},xAxis:{data:u},yAxis:{},series:[{name:i,type:"bar",barMaxWidth:20,data:c[0],itemStyle:{normal:{label:{show:!0}}}},{name:s,type:"bar",barMaxWidth:20,data:c[1],itemStyle:{normal:{label:{show:!0}}}}]};o.setOption(d)},alertMsg:function(e,t){this.scrollMsg();var a=t||"error";this.$message({message:e,duration:3600,type:a})},scrollMsg:function(){if(self!=top){var e=window.parent.document.documentElement.scrollTop||window.parent.document.body.scrollTop-50,t=document.getElementsByClassName("el-message")[0];t&&(t.style.cssText="top: "+e+"px;z-index:1000;")}}},components:{}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-body"},["0"!=e.showDateSearch?a("el-form",{ref:"form",attrs:{"label-position":e.labelPosition,model:e.form,size:"small","label-width":"120px"}},[a("el-row",{attrs:{gutter:10}},["1"!=e.showDateSearch?a("el-col",{staticStyle:{width:"500px"},attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择检索日期",prop:"sendTime"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.searchDatePickerOption},model:{value:e.form.searchDate,callback:function(t){e.$set(e.form,"searchDate",t)},expression:"form.searchDate"}})],1)],1):e._e(),e._v(" "),"1"!=e.showDateSearch?a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.searchDate}},[e._v("检索")])],1):e._e(),e._v(" "),a("el-col",{attrs:{span:5}},["2"!=e.showDateSearch?a("a",{attrs:{href:e.exportUrl+e.exportDate}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("导出")])],1):e._e()])],1)],1):e._e(),e._v(" "),a("el-table",{staticClass:"el-table-common",attrs:{data:e.weeklyRevenueData,border:""}},[a("el-table-column",{attrs:{prop:"year",label:"年份"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cycle_str",label:"日期"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weekly_number",label:"周次"}}),e._v(" "),a("el-table-column",{attrs:{prop:"equip_no_mini",label:"设备台数(除mini)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"equip_total",label:"总设备台数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weekly_turnover",label:"本期营业额"}}),e._v(" "),a("el-table-column",{attrs:{label:"营业额增长率"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.trimPercent(t.row.weekly_growth)<0?a("span",[a("i",{staticClass:"el-icon-download",staticStyle:{color:"green"}})]):e.trimPercent(t.row.weekly_growth)>0?a("span",[a("i",{staticClass:"el-icon-upload2",staticStyle:{color:"red"}})]):e._e(),e._v(e._s(t.row.weekly_growth)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"average_daily_turnover",label:"日均营业额"}}),e._v(" "),a("el-table-column",{attrs:{prop:"equip_operating_no_mini",label:"运营设备台天数(除mini)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"equip_operating_days",label:"总设备台天数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weekly_cups",label:"总杯数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weekly_pay_cups",label:"付费杯数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"equip_daily_average",label:"总台日均(杯数)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weekly_cups_average",label:"总杯均价"}}),e._v(" "),a("el-table-column",{attrs:{prop:"pay_equip_daily_average",label:"付费台日均(杯数)"}}),e._v(" "),a("el-table-column",{attrs:{label:"环比值"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.trimPercent(t.row.pay_equip_average_ratio)<0?a("span",[a("i",{staticClass:"el-icon-download",staticStyle:{color:"green"}})]):e.trimPercent(t.row.pay_equip_average_ratio)>0?a("span",[a("i",{staticClass:"el-icon-upload2",staticStyle:{color:"red"}})]):e._e(),e._v(e._s(t.row.pay_equip_average_ratio)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"pay_cups_average",label:"付费杯均价"}}),e._v(" "),a("el-table-column",{attrs:{label:"环比值"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.trimPercent(t.row.pay_cups_ratio)<0?a("span",[a("i",{staticClass:"el-icon-download",staticStyle:{color:"green"}})]):e.trimPercent(t.row.pay_cups_ratio)>0?a("span",[a("i",{staticClass:"el-icon-upload2",staticStyle:{color:"red"}})]):e._e(),e._v(e._s(t.row.pay_cups_ratio)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"weekly_free_cups",label:"免费杯数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weekly_gross_profit",label:"毛利润"}})],1),e._v(" "),e._m(0)],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"charts",attrs:{id:"equipNoMini"}}),e._v(" "),a("div",{staticClass:"charts",attrs:{id:"weeklyTurnover"}}),e._v(" "),a("div",{staticClass:"charts",attrs:{id:"weeklyFreeCups"}}),e._v(" "),a("div",{staticClass:"charts",attrs:{id:"weeklyCups"}}),e._v(" "),a("div",{staticClass:"charts",attrs:{id:"equipDailyAverage"}}),e._v(" "),a("div",{staticClass:"charts",attrs:{id:"weeklyCupsAverage"}}),e._v(" "),a("div",{staticClass:"charts",attrs:{id:"weeklyPayCups"}}),e._v(" "),a("div",{staticClass:"charts",attrs:{id:"payEquipDailyAverage"}}),e._v(" "),a("div",{staticClass:"charts",attrs:{id:"payCupsAverage"}})])}]};var d=a("C7Lr")(h,v,!1,function(e){a("b/PE")},null,null).exports;r.default.use(o.a);var _=new o.a({routes:[{path:"/",redirect:"/revenue"},{path:"/revenue",name:"WeeklyRevenue",component:d}]});r.default.use(n.a),r.default.config.productionTip=!1,new r.default({el:"#app",router:_,components:{App:s},template:"<App/>"})},"b/PE":function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.e8cb657fd424b3e69a04.js.map