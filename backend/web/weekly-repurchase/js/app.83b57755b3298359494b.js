webpackJsonp([1],{"/Hv2":function(e,t){},CuRo:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("CuRo");var r=a("IvJb"),n=a("t+b9"),l=a.n(n),s=(a("/Hv2"),{render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]}),o=a("C7Lr")(null,s,!1,null,null,null).exports,i=a("zO6J"),c=a("aozt"),h=a.n(c),u=["#328e55","#d66e49","#be384b","#a7aa9d","#354b5e"],p=["#54c7f1","#3ab2de","#289eca","#198db8","#0a7da7","#016b93"],d={data:function(){return{listUrl:"",getWeeklyRepurchaseUrl:rootCoffeeStieUrl+"weekly-report-api/weekly-repurchase-list.html",weeklyRepurchaseData:[],labelPosition:"right",form:{searchDate:""},searchDatePickerOption:{disabledDate:function(e){return e.getTime()>Date.now()}},exportDate:"",exportUrl:"/weekly-return/export?",showDateSearch:""}},filters:{formatDate:function(e){return String(e).substr(0,10)}},computed:{},mounted:function(){this.init()},methods:{init:function(){var e=this;this.showDateSearch=String(rootLogin),window.parent.onscroll=function(t){e.scrollMsg()},this.getWeeklyRepurchase()},trimPercent:function(e){return"%"==String(e).charAt(String(e).length-1)?Number(String(e).substr(0,String(e).length-1)):Number(e)},searchDate:function(){this.getWeeklyRepurchase(this.form.searchDate)},exportExcel:function(){},goBack:function(){},clearCharts:function(){this.weeklyRepurchaseData=[],this.initCharts()},getWeeklyRepurchase:function(e){var t=this,a=e?this.getWeeklyRepurchaseUrl+"?start="+e[0]+"&end="+e[1]:this.getWeeklyRepurchaseUrl;this.exportDate=e?"start="+e[0]+"&end="+e[1]:"",h.a.get(a).then(function(e){e.data&&"200"==e.data.code?(0==e.data.data.length&&t.alertMsg("没有数据，请选择其他日期"),t.weeklyRepurchaseData=[],window.setTimeout(function(){t.weeklyRepurchaseData=e.data.data,t.initCharts()},300)):(t.clearCharts(),t.alertMsg("获取周报营收数据错误"))}).catch(function(e){t.clearCharts(),t.alertMsg("周报营收接口错误")})},initCharts:function(){this.totalConversionChart(),this.weeklyConversionChart(),this.totalRepurchaseChart(),this.weeklyRepurchaseChart()},totalConversionChart:function(){this.initSingleChart("weeklyRepurchaseData","weekly_number","totalConversion","total_conversion","总转化率")},weeklyConversionChart:function(){this.initSingleChart("weeklyRepurchaseData","weekly_number","weeklyConversion","weekly_conversion","周转化率")},totalRepurchaseChart:function(){this.initSingleChart("weeklyRepurchaseData","weekly_number","totalRepurchase","total_repurchase","总复购率")},weeklyRepurchaseChart:function(){this.initSingleChart("weeklyRepurchaseData","weekly_number","weeklyRepurchase","weekly_repurchase","周复购率")},initSingleLineChart:function(e,t,a,r,n){var l=echarts.init(document.getElementById(a));l.clear();for(var s=[],o=[],i=this[e],c=0,h=i.length;c<h;c++)s.push(i[c][t]),o.push(Number(i[c][r]));var p={color:u,backgroundColor:"#fff",title:{text:n,textStyle:{fontSize:16}},tooltip:{},legend:{data:[n]},xAxis:{data:s},yAxis:{},series:[{name:n,type:"line",data:o,itemStyle:{normal:{label:{show:!0}}}}]};l.setOption(p)},initSingleChart:function(e,t,a,r,n){var l=echarts.init(document.getElementById(a));l.clear();for(var s=[],o=[],i=this[e],c=0,h=i.length;c<h;c++){s.push(i[c][t]);var u=this.trimPercent(i[c][r]);o.push(u)}var d=o.length>0?o.reduce(function(e,t){return e>t?e:t}):0,m={color:p,backgroundColor:"#fff",title:{text:n,textStyle:{fontSize:16}},tooltip:{},legend:{data:[n]},xAxis:{data:s},yAxis:{},series:[{name:n,type:"bar",barMaxWidth:30,data:o,itemStyle:{normal:{label:{show:!0},color:function(e){var t=Number(e.value);t=Math.max(0,t);var a=d>0?Math.floor(5*t/d):0;return p[a]}}}}]};l.setOption(m)},initDoubleChart:function(e,t,a,r,n,l,s,o){var i=echarts.init(document.getElementById(a));i.clear();for(var c=[],h=[[],[]],p=this[e],d=0,m=p.length;d<m;d++)c.push(p[d][t]),h[0].push(p[d][r]),h[1].push(p[d][n]);var f={color:u,backgroundColor:"#fff",title:{text:l,textStyle:{fontSize:16}},tooltip:{},legend:{data:[s,o]},xAxis:{data:c},yAxis:{},series:[{name:s,type:"bar",barMaxWidth:20,data:h[0],itemStyle:{normal:{label:{show:!0}}}},{name:o,type:"bar",barMaxWidth:20,data:h[1],itemStyle:{normal:{label:{show:!0}}}}]};i.setOption(f)},alertMsg:function(e,t){this.scrollMsg();var a=t||"error";this.$message({message:e,duration:3600,type:a})},scrollMsg:function(){if(self!=top){var e=window.parent.document.documentElement.scrollTop||window.parent.document.body.scrollTop-50,t=document.getElementsByClassName("el-message")[0];t&&(t.style.cssText="top: "+e+"px;z-index:1000;")}}},components:{}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-body"},["0"!=e.showDateSearch?a("el-form",{ref:"form",attrs:{"label-position":e.labelPosition,model:e.form,size:"small","label-width":"120px"}},[a("el-row",{attrs:{gutter:10}},["1"!=e.showDateSearch?a("el-col",{staticStyle:{width:"500px"},attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择检索日期",prop:"sendTime"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.searchDatePickerOption},model:{value:e.form.searchDate,callback:function(t){e.$set(e.form,"searchDate",t)},expression:"form.searchDate"}})],1)],1):e._e(),e._v(" "),"1"!=e.showDateSearch?a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.searchDate}},[e._v("检索")])],1):e._e(),e._v(" "),a("el-col",{attrs:{span:5}},["2"!=e.showDateSearch?a("a",{attrs:{href:e.exportUrl+e.exportDate}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("导出")])],1):e._e()])],1)],1):e._e(),e._v(" "),a("el-table",{staticClass:"el-table-common",attrs:{data:e.weeklyRepurchaseData,border:""}},[a("el-table-column",{attrs:{prop:"year",label:"年份"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cycle_str",label:"日期"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weekly_number",label:"周次"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total_conversion",label:"总转化率"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weekly_conversion",label:"周转化率"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total_repurchase",label:"总复购率"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weekly_repurchase",label:"周复购率"}})],1),e._v(" "),e._m(0)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{staticClass:"charts",attrs:{id:"totalConversion"}}),this._v(" "),t("div",{staticClass:"charts",attrs:{id:"weeklyConversion"}}),this._v(" "),t("div",{staticClass:"charts",attrs:{id:"totalRepurchase"}}),this._v(" "),t("div",{staticClass:"charts",attrs:{id:"weeklyRepurchase"}})])}]};var f=a("C7Lr")(d,m,!1,function(e){a("T0dQ")},null,null).exports;r.default.use(i.a);var y=new i.a({routes:[{path:"/",redirect:"/repurchase"},{path:"/repurchase",name:"WeeklyRepurchase",component:f}]});r.default.use(l.a),r.default.config.productionTip=!1,new r.default({el:"#app",router:y,components:{App:o},template:"<App/>"})},T0dQ:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.83b57755b3298359494b.js.map