webpackJsonp([1],{"0AzE":function(t,e){},"9GaO":function(t,e){},CuRo:function(t,e){},L0vp:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i("0AzE"),i("CuRo");var o=i("lRwf"),a=i.n(o),r=i("aiqZ"),s=i.n(r),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var l=i("C7Lr")({name:"App"},n,!1,function(t){i("UZWt")},null,null).exports,c=i("7LQH"),u=i("84iU"),m=i.n(u),d={data:function(t){return{data:{},activityId:"",labelPosition:"right",form:{activityName:"",activityStatus:"",activityDesc:"",activityTime:"",isVerifySubscribe:"",couponType:"",couponGroupId:"",days:0,bindParams:"",couponGradient:[{id:"",num:"1"}]},submitDisabled:!1,rules:{activityName:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"},{validator:function(t,e,i){setTimeout(function(){new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]").test(e)?i(new Error("不能有特殊字符")):i()},200)},trigger:"blur"}],activityTime:[{required:!0,message:"请选择日期",trigger:"change"}],activityStatus:[{required:!0,message:"请选择上线状态",trigger:"blur"}],isVerifySubscribe:[{required:!0,message:"请选择是否验证关注",trigger:"blur"}],couponType:[{required:!0,message:"请选择优惠券类型",trigger:"blur"}],couponGroupId:[{required:!0,message:"请选择优惠券套餐",trigger:"blur"}]},couponIds:[{required:!0,message:"请选择优惠券",trigger:"change"}],couponNum:[{required:!0,message:"请输入数量",trigger:"blur"},{validator:function(t,e,i){setTimeout(function(){!new RegExp("^[0-9]*$").test(e)||e<=0?i(new Error("请输入0以上整数")):i()},200)},trigger:"blur"}],editorOption:{placeholder:"请输入内容",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{align:[]}],["link"]]}}}},computed:{editor:function(){return this.$refs.myQuillEditor.quill}},mounted:function(){this.init()},methods:{init:function(){var t=this;if(window.parent.addEventListener("scroll",function(e){t.scrollMsg()},!1),this.data=rootData,this.activityId=this.getQueryString("id"),console.log("activityId..",this.activityId),null==this.activityId&&(this.activityId=""),""!=this.activityId)if(this.form.activityName=this.data.activity.activityData.activity_name,this.form.activityStatus=String(this.data.activity.activityData.status),this.form.activityDesc=this.data.activity.activityData.activity_desc,this.form.activityTime=[this.data.activity.activityData.start_time,this.data.activity.activityData.end_time],this.form.isVerifySubscribe=String(this.data.activity.is_verify_subscribe),this.form.couponType=String(this.data.activity.couponData.type),this.form.days=this.data.activity.days,this.form.bindParams=this.data.activity.activityData.bind_params,1==this.form.couponType)console.log("编辑时类型为优惠券套餐"),this.form.couponGroupId=String(this.data.activity.couponData.coupon_group_id);else{console.log("编辑时类型为优惠券"),this.form.couponGradient=[];var e=this.data.activity.couponData.sendCouponList;for(var i in e)this.form.couponGradient.push({id:i,num:e[i]})}},addCouponGradient:function(t){this.form.couponGradient.push({id:"",num:"1"}),console.log(this.form.couponGradient)},delCouponGradient:function(t){this.form.couponGradient.splice(t,1)},submitForm:function(t){var e=this;console.log("时间日期###.."+this.form.activityTime+"***"),this.$refs[t].validate(function(t){if(!t)return!1;""==e.form.activityDesc?e.alertMsg("活动说明不能为空"):e.submitFormAction()})},submitFormAction:function(){var t=this;console.log("提交"),this.submitDisabled=!0;var e=""==this.activityId?"/get-coupon-activity/create":"/get-coupon-activity/update",i={};if(2==this.form.couponType){if(this.form.couponGroupId="",this.form.couponGradient<=0)return console.log("请选择优惠券"),!1;this.form.couponGradient.forEach(function(t){i[t.id]=t.num})}var o={activityData:{activity_id:this.activityId,activity_name:this.form.activityName,status:this.form.activityStatus,activity_desc:this.form.activityDesc,start_time:this.form.activityTime[0],bind_params:this.form.bindParams,end_time:this.form.activityTime[1]},days:this.form.days,is_verify_subscribe:this.form.isVerifySubscribe,couponData:{type:this.form.couponType,coupon_group_id:this.form.couponGroupId,sendCouponList:i}};console.log("传到后台参数",o);m.a.post(e,o,{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"}).then(function(e){var i=e.data;console.log("data..",i),0==i.error_code?(t.alertMsg("保存成功！","success"),window.setTimeout(function(){window.location.href="/index.php/get-coupon-activity/index"},1e3)):(t.alertMsg(i.msg),t.submitDisabled=!1)}).catch(function(e){t.alertMsg(e),t.submitDisabled=!1})},resetForm:function(){this.form.activityDesc="",this.$refs.form.resetFields()},backToList:function(){window.setTimeout(function(){window.location.href="/index.php/get-coupon-activity/index"},300)},alertMsg:function(t,e){var i=e||"error";this.$message({message:t,duration:3600,type:i}),this.scrollMsg()},scrollMsg:function(){if(self!=top){var t=window.parent.document.documentElement.scrollTop||window.parent.document.body.scrollTop-50,e=document.getElementsByClassName("el-message")[0];e&&(e.style.cssText="top: "+t+"px;z-index:1000;")}},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?decodeURI(i[2]):null}}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content-body"},[i("div",{staticClass:"line-title"},[t._v("领券活动")]),t._v(" "),i("el-main",[i("el-form",{ref:"form",attrs:{"label-position":t.labelPosition,model:t.form,rules:t.rules,size:"small","label-width":"120px"}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"活动名称",prop:"activityName"}},[i("el-input",{model:{value:t.form.activityName,callback:function(e){t.$set(t.form,"activityName",e)},expression:"form.activityName"}})],1)],1),t._v(" "),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"活动起始日期",prop:"activityTime"}},[i("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.form.activityTime,callback:function(e){t.$set(t.form,"activityTime",e)},expression:"form.activityTime"}})],1)],1)],1),t._v(" "),i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"活动状态",prop:"activityStatus"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.activityStatus,callback:function(e){t.$set(t.form,"activityStatus",e)},expression:"form.activityStatus"}},t._l(t.data.activityStatus,function(t,e){return i("el-option",{key:e,attrs:{label:t,value:String(e)}})}),1)],1)],1),t._v(" "),i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"是否验证关注",prop:"isVerifySubscribe"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.isVerifySubscribe,callback:function(e){t.$set(t.form,"isVerifySubscribe",e)},expression:"form.isVerifySubscribe"}},t._l(t.data.isVerifySubscribe,function(t,e){return i("el-option",{key:e,attrs:{label:t,value:String(e)}})}),1)],1)],1)],1),t._v(" "),i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"每人",prop:"days"}},[i("el-input",{staticStyle:{width:"100px"},attrs:{type:"number",min:"0",value:"0"},model:{value:t.form.days,callback:function(e){t.$set(t.form,"days",e)},expression:"form.days"}}),t._v("天可领取1次\n          ")],1)],1),t._v(" "),i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"绑定参数"}},[i("el-input",{attrs:{type:"text",value:""},model:{value:t.form.bindParams,callback:function(e){t.$set(t.form,"bindParams",e)},expression:"form.bindParams"}})],1)],1)],1),t._v(" "),i("el-row",{attrs:{gutter:10}},[i("el-col",{staticStyle:{width:"120px"},attrs:{span:2}},[i("div",{staticClass:"sub-title"},[i("span",{staticStyle:{color:"#F56C6C"}},[t._v("*")]),t._v(" 活动描述")])]),t._v(" "),i("el-col",{attrs:{span:20}},[i("quill-editor",{ref:"myQuillEditor",staticClass:"editor",attrs:{options:t.editorOption},model:{value:t.form.activityDesc,callback:function(e){t.$set(t.form,"activityDesc",e)},expression:"form.activityDesc"}})],1)],1),t._v(" "),i("div",[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"优惠券类型",prop:"couponType"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.form.couponType,callback:function(e){t.$set(t.form,"couponType",e)},expression:"form.couponType"}},[i("el-option",{attrs:{label:"优惠券",value:"2"}}),t._v(" "),i("el-option",{attrs:{label:"优惠券套餐",value:"1"}})],1)],1)],1)],1)],1),t._v(" "),t._l(t.form.couponGradient,function(e,o){return 2==t.form.couponType?i("div",{key:e.id},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"优惠券",prop:"couponGradient."+o+".id",rules:t.couponIds}},[i("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.id,callback:function(i){t.$set(e,"id",i)},expression:"item.id"}},t._l(t.data.couponList,function(t,e){return i("el-option",{key:e,attrs:{label:t,value:String(e)}})}),1)],1)],1),t._v(" "),i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"数量：",prop:"couponGradient."+o+".num",rules:t.couponNum}},[i("el-input",{attrs:{type:"number",min:"1",value:"1"},model:{value:e.num,callback:function(i){t.$set(e,"num",i)},expression:"item.num"}})],1)],1),t._v(" "),i("el-col",{attrs:{span:6}},[0!=o?i("i",{staticClass:"el-icon-remove-outline iconButton",on:{click:function(e){return t.delCouponGradient(o)}}}):t._e(),t._v(" "),0==o?i("i",{staticClass:"el-icon-circle-plus-outline iconButton",on:{click:t.addCouponGradient}}):t._e()])],1)],1):t._e()}),t._v(" "),1==t.form.couponType?i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"优惠券套餐",prop:"couponGroupId"}},[i("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:t.form.couponGroupId,callback:function(e){t.$set(t.form,"couponGroupId",e)},expression:"form.couponGroupId"}},t._l(t.data.couponGroupList,function(t,e){return i("el-option",{key:e,attrs:{label:t,value:String(e)}})}),1)],1)],1)],1):t._e(),t._v(" "),i("el-form-item",{staticClass:"div_center",attrs:{size:"medium"}},[i("el-button",{attrs:{disabled:t.submitDisabled},on:{click:t.resetForm}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary",disabled:t.submitDisabled},on:{click:function(e){return t.submitForm("form")}}},[t._v("保存")])],1)],2)],1)],1)},staticRenderFns:[]};var f=i("C7Lr")(d,p,!1,function(t){i("L0vp")},null,null).exports;a.a.use(c.a);var v=new c.a({routes:[{path:"/",redirect:"/coupon"},{path:"/coupon",name:"GetCouponActivity",component:f}]});i("oTFt"),i("9GaO"),i("v/ij");a.a.use(s.a),a.a.config.productionTip=!1,new a.a({el:"#app",router:v,components:{App:l},template:"<App/>"})},UZWt:function(t,e){},lRwf:function(t,e){t.exports=Vue},oTFt:function(t,e){},"v/ij":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.e5dcbaf1878a3425a7c9.js.map