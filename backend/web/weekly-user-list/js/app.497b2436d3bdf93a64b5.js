webpackJsonp([1],{CuRo:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("CuRo");var r=a("MVMM"),s=a("Axgm"),l=a.n(s),i=(a("dRIH"),{render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]}),n=a("vSla")(null,i,!1,null,null,null).exports,o=a("zO6J"),c=a("aozt"),u=a.n(c),h=["#328e55","#d66e49","#be384b","#a7aa9d","#354b5e"],p=["#54c7f1","#3ab2de","#289eca","#198db8","#0a7da7","#016b93"],d={data:function(){return{listUrl:"",getWeeklyUserListUrl:rootCoffeeStieUrl+"weekly-report-api/weekly-user-list.html",weeklyUserListData:[],labelPosition:"right",form:{searchDate:""},searchDatePickerOption:{disabledDate:function(e){return e.getTime()>Date.now()}},exportDate:"",exportUrl:"/weekly-user/export?",showDateSearch:""}},filters:{formatDate:function(e){return String(e).substr(0,10)}},computed:{},mounted:function(){this.init()},methods:{init:function(){var e=this;this.showDateSearch=String(rootLogin),window.parent.onscroll=function(t){e.scrollMsg()},this.getWeeklyUserList()},trimPercent:function(e){return"%"==String(e).charAt(String(e).length-1)?Number(String(e).substr(0,String(e).length-1)):Number(e)},searchDate:function(){this.getWeeklyUserList(this.form.searchDate)},exportExcel:function(){},goBack:function(){},clearCharts:function(){this.weeklyUserListData=[],this.initCharts()},getWeeklyUserList:function(e){var t=this,a=e?this.getWeeklyUserListUrl+"?start="+e[0]+"&end="+e[1]:this.getWeeklyUserListUrl;this.exportDate=e?"start="+e[0]+"&end="+e[1]:"",u.a.get(a).then(function(e){e.data&&"200"==e.data.code?(0==e.data.data.length&&t.alertMsg("没有数据，请选择其他日期"),t.weeklyUserListData=[],window.setTimeout(function(){t.weeklyUserListData=e.data.data,t.initCharts()},300)):(t.clearCharts(),t.alertMsg("获取周报用户数据错误"))}).catch(function(e){t.clearCharts(),t.alertMsg("周报用户接口错误")})},initCharts:function(){this.chartUsersGrowth(),this.chartNewUsersTotal(),this.chartNewRegisteredUser(),this.chartActiveUser(),this.chartPayFreeActiveUser()},chartUsersGrowth:function(){var e=echarts.init(document.getElementById("usersGrowth"));e.clear();for(var t=[],a=[[],[],[]],r=this.weeklyUserListData,s=0,l=r.length;s<l;s++)t.push(r[s].weekly_number),a[0].push(r[s].guest_user),a[1].push(r[s].registered_user),a[2].push(r[s].users_total);var i={title:{text:"用户增长",textStyle:{fontSize:16}},tooltip:{},legend:{data:["非注册用户","注册用户","总用户数"]},calculable:!0,yAxis:[{type:"value"}],xAxis:[{type:"category",data:t}],series:[{name:"非注册用户",type:"bar",stack:"总量",barMaxWidth:20,itemStyle:{normal:{label:{show:!0,position:"insideRight"}}},data:a[0]},{name:"注册用户",type:"bar",stack:"总量",barMaxWidth:20,itemStyle:{normal:{label:{show:!0,position:"insideRight"}}},data:a[1]},{name:"总用户数",type:"bar",barMaxWidth:20,itemStyle:{normal:{label:{show:!0}}},data:a[2]}]};e.setOption(i)},chartNewUsersTotal:function(){this.initSingleChart("weeklyUserListData","weekly_number","newUsersTotal","new_users_total","新增用户")},chartNewRegisteredUser:function(){this.initSingleChart("weeklyUserListData","weekly_number","newRegisteredUser","new_registered_user","新增注册用户")},chartActiveUser:function(){this.initSingleChart("weeklyUserListData","weekly_number","activeUser","active_user","活跃用户数")},chartPayFreeActiveUser:function(){this.initDoubleChart("weeklyUserListData","weekly_number","payFreeActiveUser","pay_active_user","free_active_user","付费、免费活跃人数","付费活跃人数","免费活跃人数")},initSingleChart:function(e,t,a,r,s){var l=echarts.init(document.getElementById(a));l.clear();for(var i=[],n=[],o=this[e],c=0,u=o.length;c<u;c++){i.push(o[c][t]);var h=this.trimPercent(o[c][r]);n.push(h)}var d=n.length>0?n.reduce(function(e,t){return e>t?e:t}):0,m={color:p,backgroundColor:"#fff",title:{text:s,textStyle:{fontSize:16}},tooltip:{},legend:{data:[s]},xAxis:{data:i},yAxis:{},series:[{name:s,type:"bar",barMaxWidth:30,data:n,itemStyle:{normal:{label:{show:!0},color:function(e){var t=Number(e.value);t=Math.max(0,t);var a=d>0?Math.floor(5*t/d):0;return p[a]}}}}]};l.setOption(m)},initDoubleChart:function(e,t,a,r,s,l,i,n){var o=echarts.init(document.getElementById(a));o.clear();for(var c=[],u=[[],[]],p=this[e],d=0,m=p.length;d<m;d++)c.push(p[d][t]),u[0].push(p[d][r]),u[1].push(p[d][s]);var b={color:h,backgroundColor:"#fff",title:{text:l,textStyle:{fontSize:16}},tooltip:{},legend:{data:[i,n]},xAxis:{data:c},yAxis:{},series:[{name:i,type:"bar",barMaxWidth:20,data:u[0],itemStyle:{normal:{label:{show:!0}}}},{name:n,type:"bar",barMaxWidth:20,data:u[1],itemStyle:{normal:{label:{show:!0}}}}]};o.setOption(b)},alertMsg:function(e,t){this.scrollMsg();var a=t||"error";this.$message({message:e,duration:3600,type:a})},scrollMsg:function(){if(self!=top){var e=window.parent.document.documentElement.scrollTop||window.parent.document.body.scrollTop-50,t=document.getElementsByClassName("el-message")[0];t&&(t.style.cssText="top: "+e+"px;z-index:1000;")}}},components:{}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-body"},["0"!=e.showDateSearch?a("el-form",{ref:"form",attrs:{"label-position":e.labelPosition,model:e.form,size:"small","label-width":"120px"}},[a("el-row",{attrs:{gutter:10}},["1"!=e.showDateSearch?a("el-col",{staticStyle:{width:"500px"},attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择检索日期",prop:"sendTime"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.searchDatePickerOption},model:{value:e.form.searchDate,callback:function(t){e.$set(e.form,"searchDate",t)},expression:"form.searchDate"}})],1)],1):e._e(),e._v(" "),"1"!=e.showDateSearch?a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.searchDate}},[e._v("检索")])],1):e._e(),e._v(" "),a("el-col",{attrs:{span:5}},["2"!=e.showDateSearch?a("a",{attrs:{href:e.exportUrl+e.exportDate}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("导出")])],1):e._e()])],1)],1):e._e(),e._v(" "),a("el-table",{staticClass:"el-table-common",attrs:{data:e.weeklyUserListData,border:""}},[a("el-table-column",{attrs:{prop:"year",label:"年份"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cycle_str",label:"日期"}}),e._v(" "),a("el-table-column",{attrs:{prop:"weekly_number",label:"周次"}}),e._v(" "),a("el-table-column",{attrs:{prop:"users_total",label:"总用户数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"new_users_total",label:"新增用户"}}),e._v(" "),a("el-table-column",{attrs:{prop:"new_users_growth",label:"用户增长率"}}),e._v(" "),a("el-table-column",{attrs:{prop:"registered_user",label:"注册用户"}}),e._v(" "),a("el-table-column",{attrs:{prop:"new_registered_user",label:"新增注册用户"}}),e._v(" "),a("el-table-column",{attrs:{prop:"new_registered_growth",label:"注册用户增长率"}}),e._v(" "),a("el-table-column",{attrs:{prop:"guest_user",label:"非注册用户"}}),e._v(" "),a("el-table-column",{attrs:{prop:"active_user",label:"活跃人数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"active_user_growth",label:"活跃增长率"}}),e._v(" "),a("el-table-column",{attrs:{prop:"pay_active_user",label:"付费活跃用户"}}),e._v(" "),a("el-table-column",{attrs:{prop:"pay_user_growth",label:"付费活跃增长率"}}),e._v(" "),a("el-table-column",{attrs:{prop:"free_active_user",label:"免费活跃人数"}})],1),e._v(" "),e._m(0)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{staticClass:"charts",attrs:{id:"usersGrowth"}}),this._v(" "),t("div",{staticClass:"charts",attrs:{id:"newUsersTotal"}}),this._v(" "),t("div",{staticClass:"charts",attrs:{id:"newRegisteredUser"}}),this._v(" "),t("div",{staticClass:"charts",attrs:{id:"activeUser"}}),this._v(" "),t("div",{staticClass:"charts",attrs:{id:"payFreeActiveUser"}})])}]};var b=a("vSla")(d,m,!1,function(e){a("pdfD")},"data-v-6a508942",null).exports;r.default.use(o.a);var f=new o.a({routes:[{path:"/",redirect:"/userlist"},{path:"/userlist",name:"WeeklyUserList",component:b}]});r.default.use(l.a),r.default.config.productionTip=!1,new r.default({el:"#app",router:f,components:{App:n},template:"<App/>"})},dRIH:function(e,t){},pdfD:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.497b2436d3bdf93a64b5.js.map