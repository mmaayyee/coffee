webpackJsonp([1],{"8PZi":function(t,e){},LicG:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("CC2O"),s=a("KGCO"),i=a("aozt"),o=a.n(i),l={data:function(t){return{payTypeData:{},labelPosition:"right",id:"",form:{pay_type_icon:"",qr_bg:"",is_support_strategy:"",is_show:"",default_strategy:"",serial_id:"0"},strategyDisabled:!1,submitTipShow:!1,payType:"",payTypeIconUrl:"",qrBgUrl:"",originalQrBgUrl:"",submitFormUrl:"/pay-type/update-save",submitFlag:!0,rules:{is_support_strategy:[{required:!0,message:"请选择是否支持优惠策略",trigger:"change"}],is_show:[{required:!0,message:"请选择是否默认打开",trigger:"change"}],default_strategy:[{required:!1,message:"请选择默认优惠策略",trigger:"change"}],serial_id:[{required:!0,message:"请输入序号",trigger:"blur"},{validator:function(t,e,a){setTimeout(function(){new RegExp("^[0-9]*$").test(e)?a():a(new Error("请输入数字"))},200)},trigger:"blur"}]},payTypeList:[],defaultStrategyList:[]}},computed:{defaultStrategyShow:function(){return"1"==this.form.is_support_strategy&&"1"==this.form.is_show||(this.form.default_strategy="",!1)},payTypeIconShow:function(){return""!=this.payTypeIconUrl},qrBgShow:function(){return""!=this.qrBgUrl},serialIdShow:function(){return"1"==this.form.is_show||(this.form.serial_id="0",!1)}},mounted:function(){this.init()},methods:{init:function(){var t=this;for(var e in window.parent.onscroll=function(e){t.scrollMsg()},this.payTypeData=rootPayTypeData||{},this.payTypeData)this.payTypeList.push({value:e,label:this.payTypeData[e].name,strategy:this.payTypeData[e].discount_strategy});console.log("payTypeData..",this.payTypeData);var a=this.getQueryString("id");if(console.log(a),""!=a){var r=rootData||{};this.id=r.id,this.changeStrategy(this.id),this.form.is_support_strategy=String(r.is_support_strategy),this.form.is_show=String(r.is_show),this.form.default_strategy=String(r.default_strategy),this.form.serial_id=r.serial_id,this.payTypeIconUrl=r.pay_type_icon_url,this.qrBgUrl=r.qr_bg_url,1==r.is_use_build&&(this.form.is_support_strategy="1",this.strategyDisabled=!0),this.originalQrBgUrl=r.qr_bg_url}console.log("this.payTypeIconUrl..",this.payTypeIconUrl)},isShowChange:function(){1==this.form.is_show&&(this.form.serial_id="1")},closeIcon:function(){this.form.pay_type_icon="",this.payTypeIconUrl=""},closeQrBg:function(){this.form.qr_bg="",this.qrBgUrl=""},payTypeChange:function(){this.changeStrategy(this.id)},changeStrategy:function(t){if(""==t)return!1;this.defaultStrategyList=[],this.form.default_strategy="";var e=this.payTypeList.find(function(e){return e.value==t});for(var a in this.payType=e.label,e.strategy)this.defaultStrategyList.push({value:a,label:e.strategy[a]})},onIconUploadChange:function(t){var e=this;console.log("file..",t);var a="image/png"===t.raw.type,r=t.size/1024/50<1;if(!a)return this.$message.error("只能上传png图片!"),!1;if(!r)return this.$message.error("上传文件大小不能超过 50k !"),!1;var s=new FileReader;s.readAsDataURL(t.raw),s.onload=function(t){var a=t.target.result,r=new Image;r.onload=function(){80!=r.width||80!=r.height?e.$message.error("图片宽高尺寸不对，请重新上传"):(e.form.pay_type_icon=a,e.payTypeIconUrl=a)},r.src=a}},onQrbgUploadChange:function(t){var e=this,a="image/jpeg"===t.raw.type||"image/png"===t.raw.type,r=t.size/1024/20<1;if(!a)return this.$message.error("只能上传jpg/png图片!"),!1;if(!r)return this.$message.error("上传文件大小不能超过 20k !"),!1;var s=new FileReader;s.readAsDataURL(t.raw),s.onload=function(t){var a=t.target.result,r=new Image;r.onload=function(){40!=r.width||40!=r.height?e.$message.error("图片宽高尺寸不对，请重新上传"):(e.form.qr_bg=a,e.qrBgUrl=a)},r.src=a}},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("invalid"),e.submitTipShow=!0,!1;""==e.form.pay_type_icon&&""==e.payTypeIconUrl?e.alertMsg("请上传图标"):(e.submitTipShow=!1,e.submitFormAction())})},submitFormAction:function(){var t=this;if(!this.submitFlag)return!1;this.submitFlag=!1,""!=this.originalQrBgUrl&&""==this.qrBgUrl&&(this.form.qr_bg="-1");var e=this.submitFormUrl+"?id="+this.id,a=this.form;console.log("传到后台参数",a),o.a.post(e,a).then(function(e){var a=e.data;console.log("data.."+a),0!=a.error_code?(t.alertMsg("提交失败"),t.submitFlag=!0):(t.alertMsg("提交成功！","success"),window.setTimeout(function(){window.location.href="/pay-type/index"},1e3))}).catch(function(e){t.alertMsg(e),t.submitFlag=!0})},backToList:function(){window.setTimeout(function(){},300)},alertMsg:function(t,e){this.scrollMsg();var a=e||"error";this.$message({message:t,duration:3600,type:a})},scrollMsg:function(){if(self!=top){var t=window.parent.document.documentElement.scrollTop||window.parent.document.body.scrollTop-50,e=document.getElementsByClassName("el-message")[0];e&&(e.style.cssText="top: "+t+"px;z-index:1000;")}},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(e);return null!=a?decodeURI(a[2]):""}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-body"},[a("div",{staticClass:"line-title"},[t._v("支付方式")]),t._v(" "),a("el-main",[a("el-form",{ref:"form",attrs:{"label-position":t.labelPosition,model:t.form,rules:t.rules,size:"small","label-width":"170px"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"支付方式"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{readonly:""},model:{value:t.payType,callback:function(e){t.payType=e},expression:"payType"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"请设置支付方式图标"}},[a("el-upload",{attrs:{action:"",accept:"image/png","on-change":t.onIconUploadChange,"auto-upload":!1,"show-file-list":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传png文件,宽80px,高80px,且不能超过50k")])],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.payTypeIconShow,expression:"payTypeIconShow"}],staticClass:"img-area"},[a("img",{staticClass:"img-pay-type-icon",attrs:{src:t.payTypeIconUrl}}),t._v(" "),a("img",{staticClass:"img-close",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMBAMAAACQIoDIAAAAD1BMVEUAAAAAAAAAAAAAAAAAAABPDueNAAAABXRSTlMAP+sf8L9zLYUAAAA3SURBVAjXYwACAyBmBmIgqQgkhIB8ECXAwKgIZgFpEA8ChASBglBhFwFMJkIBQhvCMIQVSBYDAOIcA3Udj1XDAAAAAElFTkSuQmCC"},on:{click:t.closeIcon}})])])],1),t._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"请设置二维码中心图标"}},[a("el-upload",{attrs:{action:"",accept:"image/jpeg,image/png","on-change":t.onQrbgUploadChange,"auto-upload":!1,"show-file-list":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件,宽40px,高40px,且不能超过20k")])],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.qrBgShow,expression:"qrBgShow"}],staticClass:"img-area"},[a("img",{staticClass:"img-qr-icon",attrs:{src:t.qrBgUrl}}),t._v(" "),a("img",{staticClass:"img-close",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMBAMAAACQIoDIAAAAD1BMVEUAAAAAAAAAAAAAAAAAAABPDueNAAAABXRSTlMAP+sf8L9zLYUAAAA3SURBVAjXYwACAyBmBmIgqQgkhIB8ECXAwKgIZgFpEA8ChASBglBhFwFMJkIBQhvCMIQVSBYDAOIcA3Udj1XDAAAAAElFTkSuQmCC"},on:{click:t.closeQrBg}})])])],1),t._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"是否支持优惠策略",prop:"is_support_strategy"}},[a("el-select",{attrs:{clearable:"",disabled:t.strategyDisabled,placeholder:"请选择"},model:{value:t.form.is_support_strategy,callback:function(e){t.$set(t.form,"is_support_strategy",e)},expression:"form.is_support_strategy"}},[a("el-option",{attrs:{label:"是",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1)],1),t._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:t.strategyDisabled,expression:"strategyDisabled"}],staticClass:"strategy-tip"},[t._v("有设备在使用此支付方式的优惠策略")])],1)],1),t._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"是否默认打开",prop:"is_show"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:t.isShowChange},model:{value:t.form.is_show,callback:function(e){t.$set(t.form,"is_show",e)},expression:"form.is_show"}},[a("el-option",{attrs:{label:"是",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1)],1)],1)],1),t._v(" "),t.defaultStrategyShow?a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"默认优惠策略",prop:"default_strategy"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:t.form.default_strategy,callback:function(e){t.$set(t.form,"default_strategy",e)},expression:"form.default_strategy"}},t._l(t.defaultStrategyList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)],1)],1):t._e(),t._v(" "),t.serialIdShow?a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"序号",prop:"serial_id"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:t.form.serial_id,callback:function(e){t.$set(t.form,"serial_id",e)},expression:"form.serial_id"}})],1)],1)],1):t._e(),t._v(" "),a("el-form-item",{staticClass:"div_center",attrs:{size:"medium"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("form")}}},[t._v("提交")])],1),t._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:t.submitTipShow,expression:"submitTipShow"}],staticClass:"submit-tip"},[t._v("请检查所有必选项")])],1)],1)],1)},staticRenderFns:[]};var p=a("C7Lr")(l,n,!1,function(t){a("8PZi")},null,null).exports;r.default.use(s.a);var u=new s.a({routes:[{path:"/",name:"PayType",component:p}]}),g=a("DVuL"),c=a.n(g),m=(a("LicG"),{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]}),h=a("C7Lr")({name:"App"},m,!1,null,null,null).exports;r.default.use(c.a),new r.default({el:"#app",router:u,components:{App:h},template:"<App/>"})}},["NHnr"]);
//# sourceMappingURL=app.88f8b6884a7b89076906.js.map